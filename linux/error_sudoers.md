# Ошибка синтаксиса в файле /etc/sudoers

От ошибок, к сожалению никто не застрахован. В очередной раз настраивая тестовый сервер, ошибся в синтаксисе записи в файлике sudoers.
<br>Ошибка в терминале возникала следующая при вводе любых команд с sudo:

```bash
>>> /etc/sudoers: syntax error near line 26 <<<
sudo: parse error in /etc/sudoers near line 26
sudo: no valid sudoers sources found, quitting
sudo: unable to initialize policy plugin
```

Обычно хватает исправления сиснтаксиса в строке с помощью команды

```bash
pkexec visudo

# или если файл не основной, а включаемый из sudoers.d
pkexec visudo -f /etc/sudoers.d/<file_name>
```

Но в этот раз ошибка была серьезнее и так просто решить ее не удалось.<br><br>

На просторах Интернет была найдена информация по устранению таких ошибок.
Заключается она в следующем:

1. Запускаем два терминала на машине с испорченными записями sudoers
2. На одном из терминалов (назовем его первым) получим PID bash

```bash
echo $$
```

3. во второй сессии запускаем PolicyKit agent с полученным PID из первого терминала

```bash
pkttyagent --process PID
```

4. в первой сессии запускаем visudo с помощью команды

```bash
pkexec visudo
```

5. Переключаемся во вторую сессию и видим приглашение ввести пароль пользователя
6. Вводим требуемый пароль и переключаемся опять в первую сессиию
7. Исправляем ошибочную строку в файле и подтверждаем запись при выходе из редактирования

```bash
# Если ошибка не устранена, то будет примерно такая строка перед вопросом о записи
>>> /etc/sudoers: syntax error near line хх <<<

# Если ошибок не будет, то будет просто вопрос про запись и применение изменений
Options are:
  (e)dit sudoers file again
  e(x)it without saving changes to sudoers file
  (Q)uit and save changes to sudoers file (DANGER!)

What now? _
```

Ну и выводы из сложившейся ситуации...<br>
Всегда для внесения изменений в sudoers необходимо использовать

```bash
sudo visudo
```
так как он в обязательно порядке проверит перед сохранением синтаксис строк файла и выдаст предупрежделние перед сохранением.

### Навигация
[Вернуться в основное меню](../README.md)
<br> [Linux](../linux/README.md)
